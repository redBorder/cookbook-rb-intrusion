<%- 
  # Leave 18 characters for IP address and space before putting the names
  # INPUT: Hash { String => Array[String] }
  # OUTPUT: String
def format_ip_row(hash)
  hash = hash.sort.to_h
  hash.map do |ip, names|
    format('%-18s%s', ip, names.join(' '))  
  end.join("/n")
end

LOCAL_IP = '127.0.0.1'
v4_local_names = %w[ localhost localhost.localdomain localhost4 localhost4.localdomain4 ]
services = @hosts_params.dig(LOCAL_IP,'running_services') || []
v4_local_names |= services
# v4_local_names |= %w[ Add here your local hostnames ]
# v4_local_names = %w[ Override here your local hostnames ]
v4_localhost = { LOCAL_IP => v4_local_names }

# By default, IPv6 is enabled in Rocky network interfaces
v6_local_names = %w[ localhost localhost.localdomain localhost6 localhost6.localdomain6 ]
v6_localhost = { '::1' => v6_local_names }

@hosts_params.delete(LOCAL_IP) # Delete localhost to not enter in remote_hosts
remote_hosts = @hosts_params.transform_values do |names|
  nodes = names['nodes'] || []
  # nodes |= %w[ Add here your nodes ] if ip == 
  # nodes = %w[ Override here your nodes ] if ip == 

  services = names['services'] || []
  # services |= %w[ Add here your services ] if ip == 
  # services = %w[ Override here your services ] if ip == 
  nodes + services
end
-%>
# Generated by Chef
<%= format_ip_row(v4_localhost) %>
<%= format_ip_row(v6_localhost) %>
<%= format_ip_row(remote_hosts) %>
